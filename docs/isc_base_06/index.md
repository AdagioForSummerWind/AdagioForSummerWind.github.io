# ISC_base_06

> 2021秋哈工大深圳罗文坚 信息安全概论课程PPT 摘抄

# 网络威胁
## 6.1 概述	
- 威胁：用威力逼迫恫吓使人屈服。
- 网络威胁：是网络安全受到威胁、存在着危险。

随着互联网的不断发展，网络安全威胁也呈现了一种新的趋势。
- 最初，主要是计算机病毒，比如“CIH”、“大麻”等传统病毒。
- 至今，已逐渐发展为包括特洛伊木马、后门程序、流氓软件、间谍软件、广告软件、网络钓鱼、垃圾邮件等等。
- 目前的网络威胁往往是集多种特征于一体的混合型威胁。
### 6.1.1 网络威胁的三个阶段
第一阶段（1998年以前）：网络威胁主要来源于传统的计算机病毒，其特征是通过媒介复制进行传染，以攻击破坏个人电脑为目的。

第二阶段（大致在1998年以后）：网络威胁主要以蠕虫病毒和黑客攻击为主，其表现为蠕虫病毒通过网络大面积爆发、黑客攻击一些服务网站。

第三阶段（2005年以来）：网络威胁多样化，多数以偷窃资料、控制利用主机等手段谋取经济利益为目的。
### 6.1.2 网络威胁分类
从攻击发起者的角度来看：
- 一类是主动攻击型威胁，如网络监听和黑客攻击等，这些威胁都是对方人为通过网络通信连接进行的；
- 另一类就是被动型威胁，一般是用户通过某种途径访问了不当的信息而受到的攻击。例如，使用了带病毒的U盘，访问了带病毒、木马、恶意软件的网页、图片和邮件等。

依据攻击手段及破坏方式进行分类：
- 第一类是以传统病毒、蠕虫、木马等为代表的计算机病毒；
- 第二类是以黑客攻击为代表的网络入侵；
- 第三类以间谍软件、广告软件、网络钓鱼软件为代表的欺骗类威胁。

## 6.2 计算机病毒
### 6.2.1 病毒概述
- 1949年，约翰·冯·诺依曼的论文《自我繁衍的自动机理论》，从理论上论证了当今计算机病毒的存在。
- 20世纪60年代初，美国贝尔实验室的三位程序员编写了一个名为“磁芯大战”的游戏，游戏中程序通过复制自身来摆脱对方的控制。
- 1983年，美国南加州大学的弗雷德·科恩博士研制出一种在运行过程中可以复制自身的破坏性程序，第一次验证了计算机病毒的存在。
- 1984年，弗雷德·科恩发表论文《计算机病毒：原理和实验》。
- 1986年，Brain病毒，世界上流行的第一个病毒。
- 1988年，罗伯特·塔潘·莫里斯（美国前国家安全局首席科学家罗伯特·莫里斯的儿子）编写Morris蠕虫。

计算机病毒定义：
- 《中华人民共和国计算机信息系统安全保护条例》中明确定义：
病毒是指“编制或者在计算机程序中插入的破坏计算机功能或者破坏数据，影响计算机使用并且能够自我复制的一组计算机指令或者程序代码”

计算机病毒特征：
- 非授权性：在用户未知（未授权）的情况下执行。
- 寄生性：传统病毒特有；目前的网络病毒多是独立文件。
- 传染性：是否具有传染性是判断一个程序是否为计算机病毒的重要条件。
- 潜伏性：发作时间可能是预设的，不发作很难觉察出来。
- 破坏性：使正常程序无法运行；窃取资料；破坏文件等。
- 触发性：触发条件可能是时间、日期、文件类型等。

计算机病毒发展新的趋势：
- 无国界：过去，以磁盘等为媒介，从国外发现到国内流行，传播周期平均需要6-12个月；目前，Internet普及，几天甚至更短时间就传遍整个世界。
- 多样化：引导型病毒、可执行文件型病毒、宏病毒和混合型病毒，利用Java、VB和ActiveX网页技术撰写病毒等。
- 破坏性更强：修改文件（含注册表）、通信端口、用户密码，挤占内存，远程控制，等等。
- 智能化：例如，超级病毒Verona，将病毒写入邮件原文。一旦用户用Outlook预览了该邮件，病毒就会发作。
- 更加隐蔽化：主题随用户的传播改变；伪装成常用程序；病毒写入文件内部，而且文件长度不变；等等。

计算机病毒分类：
- 计算机病毒可以根据其工作原理和传播方式划分成：
- 传统病毒：寄生于宿主文件内，以可移动介质为传播途径的计算机病毒。
- 蠕虫病毒：利用网络进行复制和传播，以独立智能程序形式存在的计算机病毒。
- 木马：木马一般不会自我繁殖，也并不“刻意”去感染其他文件，而是通过伪装吸引用户下载并安装在用户的计算机内，向施种木马者提供打开的被种者计算机的门户，是施种者可以任意破坏、窃取被种者的文件，甚至远程操控被种者的计算机。

### 6.2.2 传统病毒
传统病毒的代表：
- 巴基斯坦智囊（Brain）、大麻、磁盘杀手（DISK KILLER）、CIH等。

传统病毒一般有三个主要模块组成，包括启动模块、传染模块和破坏模块。

CIH病毒：
- 感染Windows 95/98环境下PE格式的EXE文件（第一例）。
- 病毒发作时直接攻击和破坏计算机硬件系统。
- 该病毒通过文件复制进行传播。
- 计算机开机后，运行了带病毒的文件，其病毒就驻留在Wnidows核心内存里。
- 由初始化驻留模块、传染模块和破坏模块组成。

![](https://raw.githubusercontent.com/QizhengZou/Image_hosting_rep/main/20211221085130.png)

![](https://raw.githubusercontent.com/QizhengZou/Image_hosting_rep/main/20211221085229.png)
- Signature=”00455000”表明该文件是PE格式的可执行文件，且尚未感染。

![](https://raw.githubusercontent.com/QizhengZou/Image_hosting_rep/main/20211221085252.png)
### 6.2.3 蠕虫病毒
蠕虫病毒产生于20世纪80年代后期，鼎盛时期却是从20世纪90年代末开始的，而且迅速成为计算机病毒的主流。

蠕虫病毒的代表包括：
- Morris蠕虫，1988年
- 红色代码（Code Red），2001年
- 尼姆达（Nimda），2001年
- 求职信，2002年
- SQL蠕虫王，2003
- 熊猫烧香，2006年底-2007年初，中国警方破获的首例计算机病毒大案

蠕虫与传统病毒的区别：
- 传统病毒是需要“寄生”，通过感染其它文件进行传播。
- 蠕虫病毒一般不需要寄生在宿主文件中，传播途径主要包括局域网内的共享文件夹、电子邮件、网络中的恶意网页和大量存在着漏洞的服务器等。
- 可以说，蠕虫病毒是以计算机为载体，以网络为攻击对象。

蠕虫病毒与普通病毒的另一个不同是，蠕虫病毒往往能够利用漏洞。

漏洞分为**软件漏洞**和**人为缺陷**。

软件漏洞主要指程序员由于习惯不规范、错误理解或想当然，在软件中留下存在安全隐患的代码。
- 例如，缓冲区溢出漏洞、微软IE和Outlook的自动执行漏洞等。

人为缺陷主要指的是计算机用户的疏忽，这就是所谓的社会工程学（Social Engineering）问题。
- 例如，当收到标题为求职信息的邮件时，大多数人都会抱着好奇的心理去点击它，则求职信病毒将顺利侵入。

蠕虫病毒的攻击和传播主要就是利用漏洞。

尼姆达蠕虫Worms.Nimda：
- 2001年9月18日，尼姆达病毒在全球蔓延，它能够通过多种传播渠道进行传播，传染性极强，同时破坏力也极大。
- 尼姆达病毒是一个精心设计的蠕虫病毒，其结构复杂堪称历年来之最。
- 尼姆达病毒激活后，使用其副本替换系统文件；将系统的各驱动器设为开放共享，降低系统安全性；创建Guest账号并将其加入到管理员组中，安装Guest用户后门。
- 由于尼姆达病毒通过网络大量传播，产生大量异常的网络流量和大量的垃圾邮件，网络性能势必受到严重影响。

Nimda传播途径：
![](https://raw.githubusercontent.com/QizhengZou/Image_hosting_rep/main/20211221085602.png)

尼姆达病毒程序：
![](https://raw.githubusercontent.com/QizhengZou/Image_hosting_rep/main/20211221085637.png)

Nimda病毒的防范及清除：
- 感染的用户应重新安装系统，以便彻底清除其它潜在的后门。

- 如不能立刻重装系统，可参考下列步骤来清除蠕虫或者防止被蠕虫攻击：
    - 下载IE和IIS的补丁程序到受影响的主机上；
    - 安装杀毒软件和微软的CodeRedII清除程序；
    - 备份重要数据；
    - 断开网络连接（例如，拔掉网线）；
    - 执行杀毒工作，清除CodeRedII蠕虫留下的后门；
    - 安装IE和IIS的补丁；
    - 重启系统，再次运行杀毒软件以确保完全清除蠕虫。

### 6.2.4 木马
木马病毒，“木马计”，伪装潜伏的网络病毒。

1986年的PC-Write木马是世界上第一个计算机木马。
- PC-Write木马伪装成共享软件PC-Write的2.72版本。
- 事实上，编写PC-Write的Quicksoft公司从未发行过2.72版本。
- 一旦用户信以为真，运行该木马程序，那么他的下场就是硬盘被格式化。

随着Internet的普及，木马逐渐形成了独特的伪装和传播两种特征，作为黑客窃取信息的工具四处泛滥。

木马是有隐藏性的、传播性的可被用来进行恶意行为的程序。因此，也被看作是一种计算机病毒。
- 木马一般不会直接对电脑产生危害，以控制电脑为目的。当然，电脑一旦被木马所控制，后果不堪设想。

木马的传播（种木马或植入木马）方式：
- 主要通过电子邮件附件、被挂载木马的网页以及捆绑了木马程序的应用软件。
- 木马被下载安装后完成修改注册表、驻留内存、安装后门程序、设置开机加载等，甚至能够使杀毒程序、个人防火墙等防范软件失效。

木马病毒的分类：**盗号类木马、网页点击类木马、下载类木马 、代理类木马。**

木马病毒的分类：
- 盗号类木马 
    - 通常采用记录用户键盘输入、Hook应用程序进程等方法获取用户的密码和账号。
    - 窃取到的信息一般通过发送电子邮件或向远程控制程序直接提交的方式发送给木马作者。
    - 盗号木马的目标一般为游戏软件、即时通讯软件以及网上交易系统。
- 网页点击类木马
    - 模拟用户点击广告等动作，短时间内产生大量的点击量。
    - 目的一般是为了赚取高额的广告推广费用。
- 下载类木马 
    - 体积小，功能是从网络上下载其他病毒程序或安装广告软件。
    - 因为体积很小，下载类木马更容易传播，传播速度也更快。
    - 通常，功能强大、体积也很大的后门类病毒，如“灰鸽子”、“黑洞”等，传播时都单独编写一个小巧的下载型木马，用户中毒后会把后门主程序下载到本机运行。
- 代理类木马 
    - 用户感染代理类木马后，会在本机开启HTTP、SOCKS等代理服务功能。
    - 黑客将受感染的计算机作为跳板，以被感染用户的身份进行黑客活动，达到隐藏自己的目的。

木马病毒程序的组成：
- 控制端程序（客户端）
    - 是黑客用来控制远程计算机中的木马的程序。
- 木马程序（服务器端）
    - 是木马病毒的核心，是潜入被感染的计算机内部、获取其操作权限的程序。
- 木马配置程序
    - 通过修改木马名称、图标等来伪装、隐藏木马程序，并配置端口号、回送地址等信息确定反馈信息的传输路径。

灰鸽子的植入方法：
- 被动植入是指植入过程必须依赖受害用户的手工操作。一般是伪装成合法程序，以降低用户的警觉性并诱骗用户。
- 主动植入是将灰鸽子程序通过程序自动安装到目标系统，植入过程无需受害用户的操作。
- ![](https://raw.githubusercontent.com/QizhengZou/Image_hosting_rep/main/20211221090121.png)

灰鸽子的初始化安装：
- 木马程序G_Server.exe运行后，将自己复制到Windows文件夹内，并释放G_Server.dll和G_Server_Hook.dll。
    - G_Server.dll：实现后门功能，与控制客户端通信。
    - G_Server_Hook.dll：隐藏木马，包括隐藏文件、隐藏进程和隐藏通信。
    - G_Server.exe、G_Server.dll和G_Server_Hook.dll组成了灰鸽子的服务端。
    - 有的灰鸽子会多释放一个G_ServerKey.dll文件，用于记录键盘操作。
- G_Server.exe将自己注册成**服务**，以便每次开机都自动运行，在加载G_Server.dll、G_Server_Hook.dll和G_ServerKey.dll后自动退出。 G_Server.exe这个名字并不是固定的，是可以定制的。

灰鸽子的隐藏技术：
- 隐藏文件
    - 灰鸽子拦截了对API函数的调用，隐藏了木马程序和它注册的服务项。
    - 即使设置了“显示所有隐藏文件”，也看不到它们。
- 隐藏进程
    - 修改列举进程API函数的入口地址，在别的程序在调用这些函数的时候，首先转向木马程序。木马程序中需要做的工作就是在列表中将自己的进程信息去掉，从而实现进程的隐藏。
- 隐藏通讯
    - 采用通信端口复用技术和反弹端口技术。
    - 通讯端口复用技术是指将自己的通讯直接绑定到正常用户进程的端口，接收数据后，根据包格式判断是不是自己的，如果是它的，自己处理，否则通过127.0.0.1的地址交给真正的服务器应用进行处理。
    - 反弹端口技术是指木马程序启动后主动连接客户，为了隐蔽起见，控制端的被动端口一般设置为80端口。
        - 对内部网络到外部网络的访问请求，防火墙一般不进行过于严格的检查，加之其连接请求有可能伪造成对外部资源的正常访问，因此容易通过防火墙。 

灰鸽子的客户端程序：
- 客户端程序主要包括两个功能：
    - 定制生成服务器端程序。
    - 控制远程的服务器端。
- 定制生成服务器端程序：
    - 首先，利用客户端程序配置生成一个服务器端程序文件，服务器端文件的名字默认为G_ Server.exe，然后开始在网络中传播植入这个程序。
    - 木马植入成功后，系统启动时，木马就会加载运行，然后通过反弹端口技术主动连接客户控制端。
- 客户控制端程序的功能：
    - 对远程计算机文件管理：模仿Windows资源管理器，可以对文件进行复制、粘贴、删除、重命名、远程执行等，可以上传下载文件或文件夹，操作简单易用。
    - 远程控制命令：查看远程系统信息、查看剪贴板、进程管理、窗口管理、插件功能、服务管理、共享管理、代理服务、MS-DOS模拟、关机、重启。
    - 捕获屏幕，实时控制：可以连续地捕获远程计算机屏幕，并把本地的鼠标及键盘操作传送到远程被控制端，实现实时控制功能。
    - 注册表模拟器：远程操作注册表就像操作本地注册表一样方便。
- 入侵者满足私欲后，可以自行删除灰鸽子文件，这一过程用户根本无法觉察。任何悲惨的事情都有可能发生。


### 6.2.5 病毒防治
病毒防治技术略滞后于病毒技术。

对于大多数计算机用户来说，防治病毒首先需要选择一个有效的防病毒产品，并及时进行产品升级。

计算机病毒防治技术主要包括:
- 检测、清除、预防和免疫。
- 检测和清除是根治病毒的有力手段。
- 预防和免疫也是保证计算机系统安全的重要措施。

检测：
- 病毒检测方法主要包括：特征代码法、校验和法、行为监测法以及软件模拟法等。
- 特征代码法
    - 特征代码查毒就是检查文件中是否含有病毒数据库中的病毒特征代码。
    - 检测已知病毒的最简单、开销最小的方法。
    - 检测工具必须不断更新版本，无法检测从未见过的新病毒。
- 校验和法 
    - 对正常状态下的重要文件进行计算，取得其校验和，以后定期检查这些文件的校验和与原来保存的校验和是否一致。
    - 既可检测已知病毒，又可发现未知病毒。
    - 因为文件内容的改变有可能是正常程序引起的，所以校验和法使用不当可能会引起误报。
- 行为监测法 
    - 利用病毒的特有行为特征来监测病毒的方法，称为行为监测法。当一个可疑程序运行时，监视其行为，如果发现了病毒行为，立即报警。
    - 可以发现未知病毒，但容易引起误报。
- 软件模拟法
    - 软件模拟法是为了对付多态型病毒。
    - 多态病毒：每次感染时，采用随机方法对病毒主体进行加密，放入宿主程序的代码互不相同，特征代码法无法检测。
    - 通过模拟病毒的执行环境，为其构造虚拟机，在虚拟机中执行病毒引擎解码程序，安全地将多态型病毒解开并还原其本来面目，再加以扫描。
    - 软件模拟法的优点是可识别未知病毒、病毒定位准确、误报率低；缺点是检测速度受到一定影响、消耗系统资源较高。

计算机中毒的常见症状：
- 系统运行速度减慢；
- 系统经常无故发生死机；
- 文件长度发生变化；
- 存储的容量异常减少；
- 丢失文件或文件损坏；
- 屏幕上出现异常显示；
- 系统的蜂鸣器出现异常声响；
- 磁盘卷标发生变化；
- 系统不识别硬盘；
- 对存储系统异常访问；
- 键盘输入异常；
- 文件的日期、时间、属性等发生变化；
- 文件无法正确读取、复制或打开；
- 命令执行出现错误；
- WINDOWS操作系统无故频繁出现错误；
- 系统异常重新启动；
- 一些外部设备工作异常；
- 出现异常的程序驻留内存

清除：
- 清除病毒主要分为使用防病毒软件和手工清除病毒两种方法。
    - 防病毒软件由安全厂商精心研制，可以有效查杀绝大多数计算机病毒，多数用户应采用防病毒软件来清除病毒。
        - 防病毒软件对检测到的病毒一般采取三种处理方案，分别是清除、隔离和删除。
        - 清除是指在发现文件被感染病毒时，采取的清除病毒并保留文件的动作。
        - 隔离是指在发现病毒后，无法确认清除动作会带来什么后果，又不想直接删除文件，故采取监视病毒并阻止病毒运行的方法。
    - 如果某类病毒清除失败、删除失败、隔离失败，对个人用户来讲，格式化硬盘、重建系统可能就是最后的有效选择

蠕虫或木马等病毒的清除：
- 目前，Windows操作系统下的病毒大多是蠕虫病毒或木马等网络病毒，对于这类病毒，其手工清除过程大致如下。
1. 结束所有可疑进程
    - 运行中的病毒，会因为文件正在使用而无法被删除，因此在清除病毒之前必须终止病毒的运行。
    - 断开网络，关闭所有应用程序。
    - 使用netstat -an分析机器上是否有后门程序在运行。
    - 使用tasklist/m 来查看当前运行的进程（所有exe和dll），使用tasklist/v查看进程对应的程序是否真实。病毒通常会使用一个和系统程序相似或相同的名称。
    - 有的病毒不止一个进程，相互守护，或者它以dll注入形式存在，可以使用ntsd -c q -p PID杀死进程，PID为进程标识符。
2. 删除病毒文件并恢复注册表
    - 在安全模式下，删除病毒文件，恢复注册表。
3. 内核级后门的清除
    - 感染了这类病毒后，即使有的应用程序并没有感染病毒，但它们的输出依然被病毒控制，用户可能得到虚假的文件列表、服务列表、进程列表和注册表键值。整个系统将是不可信任的。重装系统！
4. 重启后扫描
    - 完成了上述三步，随后需要重新启动系统，并使用带有最新病毒库的防病毒软件对全盘进行扫描（这一步非常重要，做不好的话前功尽弃）。

预防：
- 安装防毒软件
    - 打开你的防毒软件的自动升级服务，定期扫描计算机。
- 注意U盘、光盘等存储媒介
    - 在使用软盘、光盘、U盘或活动硬盘前，进行病毒扫描。
- 关注下载安全
    - 下载要从比较可靠的站点进行，下载后做病毒扫描。 
- 关注电子邮件安全
    - 来历不明的邮件决不要打开，决不要轻易运行附件。
- 使用基于客户端的防火墙 
    - 可以增强抵御黑客和恶意代码攻击的能力。
- 警惕欺骗性的病毒
    - 警惕欺骗型病毒。天下没有免费的午餐。
- 备份

免疫：
- 计算机病毒免疫：提高计算机系统对计算机病毒的抵抗力，从而达到防止病毒侵害的目的，包括两个方面：
    - 提高计算机系统的健壮性
    - 给计算机注射“病毒疫苗”。
- 提高系统健壮性的主要途径包括以下内容：
    - 及时升级操作系统，保证系统安装最新的补丁；
    - 安装防病毒软件，及时升级病毒定义文件和防病毒引擎；
    - 定期扫描系统和磁盘文件；
    - 打开个人防火墙；
    - 使用软盘或U盘写保护；
    - 重要的数据信息写入只读光盘。

注射“病毒疫苗”：
- 实施免疫，伪装系统或软件已被某病毒感染，主要方法包括： 
    - 感染标识免疫：人为地为正常对象中加上病毒感染标识，使计算机病毒误以为已经感染，从而达到免疫的目的。 
    - 文件扩展名免疫：将扩展名改为非COM、EXE、SYS、BAT等形式，防止以扩展名为传染条件的文件型病毒的侵入。
        - 将系统默认的可执行文件的后缀名改为非COM、EXE、SYS、BAT等形式，以便用户使用。
    - 外部加密免疫：在文件的存取权限和存取路径上进行加密保护，以防止文件被非法阅读和修改。
    - 内部加密免疫：对文件内容加密变换后进行存储，使用时再进行解密。

## 6.3 网络入侵
1980年，James P Anderson首次提出了“入侵”的概念。
- “入侵”是指在非授权的情况下，试图存取信息、处理信息或破坏系统，以使系统不可靠或不可用的故意行为。

网络入侵（Network Intrusion）一般是指具有熟练编写、调试和使用计算机程序的技巧的人，利用这些技巧来获得非法或未授权的网络或文件的访问，进入内部网的行为。

注意：对信息的非授权访问一般被称为破解（Cracking）。

网络入侵一般分为三个阶段：
- **前期准备、实施入侵和后期处理。**

网络入侵的三个阶段：
- 前期准备阶段需要完成的工作主要包括明确入侵目的、确定入侵对象以及选择入侵手段。
    - 入侵目的一般可分为控制主机、瘫痪主机和瘫痪网络；
    - 入侵对象一般分为主机和网络两类；
    - 根据目的和后果，入侵手段分为：拒绝服务攻击、口令攻击、嗅探攻击、欺骗攻击和利用型攻击。
- 实施入侵阶段是真正的攻击阶段，主要包括扫描探测和攻击。
    - 扫描探测：主要用来收集信息，为下一步攻击奠定基础；
    - 攻击：根据入侵目的、采用相应的入侵手段向入侵对象实施入侵。
- 后期处理阶段主要是指由于大多数入侵攻击行为都会留下痕迹，攻击者为了清除入侵痕迹而进行现场清理。

### 6.3.1 拒绝服务攻击
- 拒绝服务攻击DoS (Denial of Service)
    - DoS并不是某一种具体的攻击方式，而是攻击所表现出来的结果最终使得目标系统因遭受某种程度的破坏而不能继续提供正常的服务，甚至导致物理上的瘫痪或崩溃。
    - 又称为业务否决攻击。
- 通常拒绝服务攻击可分为两种类型：
    - 第一类攻击是利用网络协议的缺陷，通过发送一些非法数据包致使主机系统瘫痪；
    - 第二类攻击是通过构造大量网络流量致使主机通讯或网络堵塞，使系统或网络不能响应正常的服务。

Ping of Death：
- 根据TCP/IP的规范，一个包的长度最大为65536字节。
- 但是，利用多个IP包分片的叠加能做到构造长度大于65536的IP数据包。
- 攻击者通过修改IP分片中的偏移量和段长度，使系统在接收到全部分段后重组报文时总的长度超过了65535字节。
- 一些操作系统在对这类超大数据包的处理上存在缺陷，当安装这些操作系统的主机收到了长度大于65536字节的数据包时，会出现内存分配错误，从而导致TCP/IP堆栈崩溃，造成死机。

Tear drop:
- IP数据包在网络传递时，数据包可能被分成多个更小的IP分片。
- 攻击者可以通过发送两个（或多个）IP分片数据包来实现Tear Drop攻击。
    - 第一个IP分片包的偏移量为0，长度为N，第二个分片包的偏移量小于N，未超过第一个IP分片包的尾部，这就出现了偏移量重叠现象。
- 一些操作系统无法处理这些偏移量重叠的IP分片的重组，TCP/IP堆栈会出现内存分配错误，造成操作系统崩溃。

Syn Flood:
- 攻击者伪造TCP的连接请求，向被攻击的设备正在监听的端口发送大量的SYN连接请求报文；
- 被攻击的设备按照正常的处理过程，发送SYN ACK报文，回应连接请求报文，同时为它分配了相应的资源。
- 攻击者不需要建立TCP连接，因此服务器根本不会接收到第三个ACK报文，现有分配的资源只能等待超时释放。
- 如果攻击者能够在超时时间到达之前发出足够多的攻击报文，被攻击的系统所预留的所有TCP缓存将被耗尽，无法向正常用户提供服务，攻击者达到了攻击的目的（拒绝服务）。

Smurf攻击：
- Smurf攻击是以最初发动这种攻击的程序Smurf来命名的，这种攻击方法结合使用了IP地址欺骗和ICMP协议。
- 当一台网络主机通过广播地址将ICMP ECHO请求包发送给网络中的所有机器，网络主机接收到请求数据包后，会回应一个ICMP ECHO响应包，这样发送一个包会收到许多的响应包。
- Smurf构造并发送源地址为受害主机地址、目的地址为广播地址的ICMP ECHO请求包，收到请求包的网络主机会同时响应并发送大量的信息给受害主机，致使受害主机崩溃。
- 如果Smurf攻击将回复地址设置成受害网络的广播地址，则网络中会充斥大量的ICMP ECHO响应包，导致网络阻塞。

Smurf攻击过程示意图：
![](https://raw.githubusercontent.com/QizhengZou/Image_hosting_rep/main/20211221093344.png)

电子邮件炸弹：
- 实施电子邮件炸弹攻击的特殊程序称为Email Bomber。
- 邮箱容量是有限的，用户在短时间内收到成千上万封电子邮件，而且每个电子邮件也比较大，那么经过一轮邮件炸弹轰炸后电子邮箱的容量可能被占满。
    - 其他人发给用户的电子邮件将会丢失或者被退回，使用户的邮箱失去作用。
- 这些电子邮件炸弹所携带的大容量信息不断在网络上来回传输，很容易堵塞网络。
- 邮件服务器需要不停地处理大量的电子邮件，如果承受不了这样的疲劳工作，服务器随时有崩溃的可能。

DDoS:
- 随着计算机处理能力的快速增长，内存的大量增加，以及千兆级别网络的使用，DoS攻击很难有效。
- 分布式拒绝服务攻击DDOS（Distributed Denial of Service）就是很多DoS攻击源一起攻击某台服务器或网络，迫使服务器停止提供服务或网络阻塞。
- DDoS攻击需要众多攻击源，而黑客获得攻击源的主要途径就是传播木马。
    - 网络计算机一旦中了木马，这台计算机就会被后台操作的人控制，也就成了所谓的“肉鸡”，即黑客的帮凶。
- 使用“肉鸡”进行DDoS攻击，还可以在一定程度上保护攻击者，使其不易被发现。

DoS攻击的防御方法：
- 及时为系统升级，减少系统漏洞。很多DoS攻击对于新的操作系统已经失效，例如，Ping of Death攻击。
- 将主机或网络中的不必要的服务和端口关掉。
例如，对于非WEB主机关掉80端口。
- 局域网应该加强防火墙和入侵检测系统的应用和管理，过滤掉非法的网络数据包。 

### 6.3.2 口令攻击
口令攻击步骤：
- 步骤一、获取目标系统的用户帐号及其它有关信息；
- 步骤二、根据用户信息猜测用户口令；
    - 使用对于用户来说有意义的、便于记忆的数据做口令将是危险的，如用户名、用户名变形、生日、电话、电子邮件地址等。
- 步骤三、采用字典攻击方式探测口令；
- 步骤四、探测目标系统的漏洞，伺机取得口令文件，破解取得用户口令。
- 关于获取目标系统的用户帐号及其它有关信息：一般利用一些网络服务来实现，如Finger、WHOIS、LDAP等信息服务。
- **Finger**是UNIX系统中用于查询用户情况的实用程序。UNIX系统保存了每个用户的详细资料，可以用Finger命令查询。
- **WHOIS**服务是一个在线的“请求/响应”式服务。WHOIS Server运行在后台监听43端口，当Internet用户搜索一个域名（或主机、联系人等其他信息时），WHOIS Server接收用户请求的信息并据此查询后台域名数据库。如果数据库中存在相应的记录，它会将相关信息，如所有者、管理信息以及技术联络信息等，反馈给用户。
- **LDAP**是轻量级目录访问协议，其目录中存放着各类信息，如Email、联系人列表等。
- 关于**字典攻击**：
    - 使用一些程序，自动地从电脑字典中取出一个单词，作为用户的口令输入给远端的主机，进入系统。
    - 如果口令错误，就按序取出下一个单词，进行下一个尝试。并一直循环下去，直到找到正确的口令或字典的单词试完为止。
    - 由于这个破译过程由计算机程序来自动完成，几个小时就可以把字典的所有单词都试一遍。
    - 一般情况下，密码错误的连续登录次数是受限制的。

口令数量：
- 攻击者还可能采用穷举暴力攻击的方法来攻击口令。
- 一般而言，系统中可以用作口令的字符有95个：
    - 10个数字、33个标点符号、52个大小写字母。
    - 采用任意5个字母加上一个数字或符号则可能的排列数约为163亿，即525 × 43=16,348,773,000。
    - 这个数字对于每秒可以进行上百万次浮点运算的计算机并不是什么困难问题，也就是说一个6位的口令将不是安全的。
- 一般建议使用10位以上并且是字母、数字加上标点符号的混合体。

防范口令攻击的方法：
- 口令的长度不少于10个字符；
- 口令中要有一些非字母；
- 口令不在英语字典中；
- 不要将口令写下来；
- 不要将口令存于电脑文件中； 
- 不要选择易猜测的信息做口令； 
- 不要在不同系统上使用同一口令； 
- 不要让其他人得到口令； 
- 经常改变口令；
- 永远不要对自己的口令过于自信。

### 6.3.3 嗅探攻击
嗅探攻击也称为网络嗅探，是指利用计算机的网络接口截获目的地为其它计算机的数据包的一种手段。

网络嗅探的工具被称为**嗅探器（sniffer）**，是一种常用的收集网络上传输的有用数据的方法。
- 这些数据可以是网络管理员需要分析的网络流量，也可以是黑客喜欢的用户账号和密码，或者一些商用机密数据等。

嗅探攻击一般是指黑客利用嗅探器获取网络传输中的重要数据。

网络嗅探也被形象地称为**网络窃听**。

共享网络环境：
- 以太网卡（也称作网络适配器或网络接口）共有四种工作方式：
    - 广播方式：网卡能够接收网络中的广播数据；
    - 组播方式：网卡能够接收组播数据；
    - 直接方式：只有目的网卡才能接收该数据；
    - 混杂模式：网卡能够接收一切通过它的数据。
- 如果攻击者获得其中一台主机的root权限，并将其网卡置于混杂模式，这就意味着不必打开配线盒来安装偷听设备，就可以对在共享环境下的其它计算机的通信进行窃听，在共享网络中网络通信没有任何安全性可言。
- 目前，采用“共享技术”的网络设备集线器已经被采用交换方式的交换机所取代。在大多数局域网中，利用混杂模式进行监听已经不可能了。

交换网络环境：
- 交换网络下的窃听是利用ARP欺骗实现的。 
- ARP（Address Resolution Protocol）协议：当主机接收到ARP应答数据包的时候，就使用应答数据包内的数据对本地的ARP缓存进行更新或添加。
    - ARP协议并不只是在发送了ARP请求并接收ARP应答后，添加ARP地址缓存。
![](https://raw.githubusercontent.com/QizhengZou/Image_hosting_rep/main/20211221095038.png)

ARP欺骗：
- 主机D给局域网中的所有主机发送ARP应答。主机A和B更新其ARP缓存表，主机C显示IP地址冲突。
- ![](https://raw.githubusercontent.com/QizhengZou/Image_hosting_rep/main/20211221095126.png)
- 假设主机D想监听主机A和主机C之间的通信内容：
    - D给A发送ARP应答，告诉A，192.168.1.3主机的MAC地址是dd-dd-dd-dd-dd-dd。
    - D给C发送ARP应答，告诉C，192.168.1.1主机的MAC地址是dd-dd-dd-dd-dd-dd。
    - A想要发送给C的数据实际上发送给了D，D在嗅探到数据后将此数据转发给C。
    - C回应A的数据也发给了D，D嗅探之后转发给A。
    - 这样可以保证A和C的通信不被中断，同时达到了嗅探的目的。

防范嗅探攻击：
- 检测嗅探器 
    - 通过检测混杂模式网卡来检查嗅探器的存在，例如AntiSniff工具。
- 安全的拓扑结构
    - 嗅探器只能在当前网络段上进行数据捕获。将网络分段工作进行得越细，嗅探器能够收集的信息就越少。 
- 会话加密 
    - 即使嗅探器嗅探到数据报文，也不能识别其内容。
- 地址绑定
    - 在客户端使用ARP命令绑定网关的真实MAC地址；
    - 在交换机上做端口与MAC地址的静态绑定；
    - 在路由器上做IP地址与MAC地址的静态绑定；
    - 用静态的ARP信息代替动态的ARP信息。
### 6.3.4 欺骗类攻击
欺骗类攻击是指构造虚假的网络消息，发送给网络主机或网络设备，企图用假消息替代真实信息，实现对网络及主机正常工作的干扰破坏。

常见的假消息攻击方式：
- IP欺骗
- ARP欺骗
- DNS欺骗
- 伪造电子邮件

IP欺骗：
- IP欺骗简单地说就是一台主机设备冒充另外一台主机的IP地址，与其它设备通信。
- IP欺骗主要是基于远程过程调用RPC的命令，比如rlogin、rcp、rsh等，
    - 这些命令仅仅根据信源IP地址进行用户身份确认，以便允许或拒绝用户RPC。
- IP欺骗的目的主要是获取远程主机的信任及访问特权

IP欺骗攻击主要步骤：
- 第一步：选定目标主机并发现被该主机信任的其它主机；
- 第二步：使得被信任的主机丧失工作能力，如SYN Flood攻击；
- 第三步：使用被目标主机信任的主机的IP地址，伪造建立TCP连接的SYN请求报文，试图以此数据报文建立与目标主机的TCP连接；
- 第四步：序列号取样和猜测。
- 第五步：使用被目标主机信任的主机的IP地址和计算出的TCP序列号，构造TCP连接的ACK报文（源IP为被目标主机信任的主机的IP地址），发送给目标主机，建立起与目标主机基于地址验证的应用连接。
    - 如果成功，攻击者可以使用一种简单的命令放置一个系统后门，以进行非授权操作。
- 序列号取样和猜测：
    - 如果攻击者可以截获目标主机的SYN-ACK数据包，则可以直接计算出目标主机接收的TCP序列号，来伪造TCP数据包；
    - 否则，只能采取猜测计算的方法，攻击者先与目标主机的一个端口（如SMTP）建立起正常的连接，这个过程被重复若干次，并将目标主机的初始化系列号ISN存储起来，攻击者需要估计他的主机与被信任主机之间的往返时间RTT，然后可以预测ISN大小，并计算可能的TCP序列号。
    - ISN：Initial Sequence Number

DNS欺骗：
- DNS欺骗的目的是冒充域名服务器，把受害者要查询的域名对应的IP地址伪造成欺骗着希望的IP地址。
- ![](https://raw.githubusercontent.com/QizhengZou/Image_hosting_rep/main/20211221095547.png)

伪造电子邮件：
- 由于SMTP并不对邮件的发送者的身份进行鉴定，攻击者可以冒充别的邮件地址伪造电子邮件。
- 攻击者伪造电子邮件的目的主要包括：
    - 攻击者想隐藏自己的身份，匿名传播虚假信息，如造谣中伤某人；
    - 攻击者想假冒别人的身份，提升可信度，如冒充领导发布通知；
    - 伪造用户可能关注的发件人的邮件，引诱收件人接收并阅读，如传播病毒、木马等。

对于欺骗类攻击的防范方法：
- 抛弃基于地址的信任策略，不允许使用r类远程调用命令。
- 配置防火墙，拒绝网络外部与本网内具有相同IP地址的连接请求；过滤掉入站的DNS更新。
- 地址绑定，在网关上绑定IP地址和MAC地址；在客户端使用ARP命令绑定网关的真实MAC地址命令。
- 使用PGP等安全工具并安装电子邮件证书。
    - PGP（Pretty Good Privacy，优良保密协议）是一套用于消息加密、验证的应用程序。PGP中，每个公钥均绑定唯一的用户名和/或者E-mail地址。

### 6.3.5 利用型攻击
利用型攻击是通过非法技术手段，试图获得某网络计算机的控制权或使用权，达到利用该机从事非法行为的一类攻击行为的总称。

利用型攻击常用的技术手段主要包括：
- 口令猜测
- 木马病毒
- 僵尸病毒
- 缓冲区溢出

僵尸病毒（Bot）
- 僵尸病毒是通过特定协议的信道连接僵尸网络服务器的客户端程序。
    - 被安装了僵尸程序的机器称为僵尸主机，
    - 僵尸网络（BotNet）是由这些受控的僵尸主机依据特定协议所组成的网络。
    - 僵尸网络常用的协议包括IRC（Internet Relay Chat）、HTTP、P2P等。
- 僵尸病毒的程序结构与木马程序基本一致。
    - 木马程序是被控制端连接的服务器端程序。
    - 僵尸程序是向控制服务器发起连接的客户端程序。
- 僵尸病毒的传播和木马相似，传播途径包括：
    - 电子邮件；
    - 含有病毒的WEB网页；
    - 捆绑了僵尸程序的应用软件；
    - 利用系统漏洞攻击加载等。
- 黑客经常利用僵尸病毒发起大规模的网络攻击，如分布式拒绝服务攻击（DDoS）、海量垃圾邮件等，

缓冲区溢出：
- 缓冲区溢出是指当计算机程序向缓冲区内填充数据位数时超过了缓冲区本身的容量时，溢出的数据覆盖了合法数据。
- 缓冲区溢出是一种非常普遍、非常危险的程序漏洞，在各种操作系统、应用软件中广泛存在。
- 缓冲区溢出攻击，可以导致程序运行失败、系统宕机、重新启动等后果；更为严重的是可以利用它执行非授权指令，甚至可以取得系统特权并控制主机，进行各种非法操作。
- 缓冲区溢出的产生存在着必然性，现代计算机程序的运行机制、C语言的开放性及编译问题是其产生的理论基础。
    - 程序在4GB或更大逻辑地址空间内运行时，一般会被装载到相对固定的地址空间，使得攻击者可以估算用于攻击的代码的逻辑地址；
    - 程序调用时，可执行代码和数据共同存储在一个地址空间（堆栈）内，攻击者可以精心编制输入的数据，通过运行时缓冲区溢出，得到运行权；
    - CPU CALL调用时的返回地址和C语言函数使用的局部变量均在堆栈中保存，而且C语言不进行数据边界检查，当数据被覆盖时也不能被发现。
- 一般来说，缓冲区溢出漏洞是程序员写程序时的马虎所致。
- 在很多服务程序中，大意的程序员使用了像strcpy()和strcat()等不能进行有效位检查的函数。
- 攻击者利用这一问题，设计编写一些代码，并将该代码设法加载到缓冲区有效载荷末尾。
    - 这样，当发生缓冲区溢出时，返回指针指向恶意代码，从而获得系统的控制权。

缓冲区溢出的例子：
```c
#include <stdio.h>
#include <string.h> 
void Sayhello(char* name)
{
  char tmpName [8]; 
  strcpy(tmpName, name); 
  printf("Hello %s\n", tmpName); 
} 
int main(int argc, char** argv)
{
  Sayhello(argv[1]); 
  return 0;
} 
```
下面内容是在Linux环境下example.c程序的执行情况：
```
$ ./ example computer 
Hello computer
$ ./ example computerssssssss
Hello computerssssssss
Segmentation fault (core dumped)
```
分析：
![](https://raw.githubusercontent.com/QizhengZou/Image_hosting_rep/main/20211221100524.png)
## 6.4 诱骗类威胁
诱骗类威胁是指攻击者利用社会工程学的思想，利用人的弱点（如人的本能反应、好奇心、信任、贪便宜等）通过网络散布虚假信息，诱使受害者上当受骗，而达到攻击者目的的一种网络攻击行为。

准确地说，社会工程学不是一门科学，而是一门艺术和窍门，它利用人的弱点，以顺从你的意愿、满足你的欲望的方式，让你受骗上当。

例如，利用短信诈骗银行信用卡号码。

网络钓鱼：
- Phishing是英单词Fishing（钓鱼）和Phone（电话，因为黑客起初以电话作案）的综合体，所以被称为网络钓鱼。
- Phishing是指攻击者通过伪造以假乱真的网站和发送诱惑受害者按攻击者意图执行某些操作的电子邮件等方法，使得受害者“自愿”交出重要信息（例如银行账户和密码）的手段。
- 电子邮件诱骗
- 假冒网站
- 虚假的电子商务

电子邮件诱骗：
- 电子邮件服务是合法的Internet经典服务，攻击者进行电子邮件诱骗，一般需要经过以下几个步骤。
    - 选定目标用户群：购买电子邮件地址；从公开的网站收集；邮件地址字典（常用名随机组合+服务提供商，例如bobsmith@gmail.com、bobsmith@163.com）。
    - 构造欺骗性电子邮件：往往包含一个容易混淆的链接，冒充受害者所信任的组织机构。
    - 搭建欺骗性网站：搭建域名和网页内容都与真正的被受害者所信任的组织机构网站极为相似的网站。
    - 群发邮件，等待上当的受害者。

假冒网站：
- 建立假冒网站，骗取用户帐号、密码实施盗窃，这是对用户造成经济损失最大的恶劣手段。
- 攻击者建立起域名和网页内容都与真正的网上银行、网上证券交易等重要部门网站极为相似的假冒网站，并通过各种方式传播给用户。
- 例如，非法网址为“http: //www. 1cbc. com. cn”，而真正银行的网址是“http: //www. icbc. com. cn”，

虚假的电子商务：
- 攻击者建立电子商务网站，或是在比较知名、大型电子商务网站上发布虚假的商品销售信息。
- 网上交易多是异地交易，通常需要汇款。
- 不法分子一般要求消费者先付部分款，再以各种理由诱骗消费者付余款或者其他各种名目的款项，得到钱款或被识破时，犯罪分子就销声匿迹。

对于诱骗类威胁的防范：
- 诱骗类威胁不属于传统信息安全的范畴，传统信息安全办法解决不了非传统信息安全的威胁。
    - 一般认为，解决非传统信息安全威胁需要运用社会工程学来反制。
    - 防范诱骗类威胁的首要方法是加强安全防范意识，多问“为什么”，减少 “天上掉馅饼”的心理，那么绝大多数此类诱骗行为都不能得逞。
- 另外，用户还应该注意以下几点：
    - 确认对方身份。
    - 慎重对待个人信息。
    - 谨防电子邮件泄密：不要在电子邮件中泄露私人的或财务方面的信息。
    - 注意网站的URL地址。

