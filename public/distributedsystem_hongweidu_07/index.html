<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>DistributedSystem_HongweiDu_07 - 绿叶律动</title><meta name="Description" content="绿叶律动"><meta property="og:title" content="DistributedSystem_HongweiDu_07" />
<meta property="og:description" content="2021哈工大深圳堵宏伟分布式系统课程笔记 Internetworking网际路由 Internet Structure: Network of Networks： Internet is in a hierarchical structure National/ International Backbone Providers (NBP) e.g. BBN/GTE, Sprint, AT&amp;T, IBM, UUNet" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jefofrank.xyz/distributedsystem_hongweidu_07/" /><meta property="og:image" content="https://jefofrank.xyz/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-03T14:36:03+08:00" />
<meta property="article:modified_time" content="2022-10-08T19:55:40+08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://jefofrank.xyz/logo.png"/>

<meta name="twitter:title" content="DistributedSystem_HongweiDu_07"/>
<meta name="twitter:description" content="2021哈工大深圳堵宏伟分布式系统课程笔记 Internetworking网际路由 Internet Structure: Network of Networks： Internet is in a hierarchical structure National/ International Backbone Providers (NBP) e.g. BBN/GTE, Sprint, AT&amp;T, IBM, UUNet"/>
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://jefofrank.xyz/distributedsystem_hongweidu_07/" /><link rel="prev" href="https://jefofrank.xyz/distributedsystem_hongweidu_06/" /><link rel="next" href="https://jefofrank.xyz/distributedsystem_hongweidu_08/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "DistributedSystem_HongweiDu_07",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/jefofrank.xyz\/distributedsystem_hongweidu_07\/"
        },"image": ["https:\/\/jefofrank.xyz\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "distributed system","wordcount":  1723 ,
        "url": "https:\/\/jefofrank.xyz\/distributedsystem_hongweidu_07\/","datePublished": "2021-12-03T14:36:03+08:00","dateModified": "2022-10-08T19:55:40+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "Jefo","logo": "https:\/\/jefofrank.xyz\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "Jefo"
            },"description": ""
    }
    </script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-193031966-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-193031966-2');
</script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="绿叶律动"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> All posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/jf-011101" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="直接搜索更方便^-^" id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="绿叶律动"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="直接搜索更方便^-^" id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">All posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/jf-011101" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">DistributedSystem_HongweiDu_07</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/jf-011101" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>Jefo</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/school-courses/"><i class="far fa-folder fa-fw"></i>School courses</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-12-03 14:36:03">2021-12-03 14:36:03</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 1723 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 4 分钟&nbsp;<span id="busuanzi_container_page_pv">
                    <i class="far fa-eye fa-fw"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>&nbsp;次阅读量</span>
                </span>
            </div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents"></nav></div>
            </div><div class="content" id="content"><blockquote>
<p>2021哈工大深圳堵宏伟分布式系统课程笔记</p>
</blockquote>
<h1 id="internetworking网际路由">Internetworking网际路由</h1>
<p>Internet Structure: Network of Networks：</p>
<ul>
<li>Internet is in a hierarchical structure
<ul>
<li>National/ International Backbone Providers (NBP)
<ul>
<li>e.g. BBN/GTE, Sprint, AT&amp;T, IBM, UUNet</li>
<li>interconnect (peer) with each other privately, or at public Network Access Point (NAPs)</li>
</ul>
</li>
<li>Regional ISPs
<ul>
<li>connect into NBPs</li>
</ul>
</li>
<li>Local ISP
<ul>
<li>connect into regional ISPs</li>
</ul>
</li>
</ul>
</li>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222100925.png"
        data-srcset="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222100925.png, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222100925.png 1.5x, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222100925.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222100925.png"
        title="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222100925.png" /></li>
</ul>
<p>Internet Protocol (IP)：</p>
<ul>
<li>The IP protocol, defined in RFC 791 (1981) at Layer 3, specifies:
<ul>
<li>Internet packet format</li>
<li>Internet addressing</li>
<li>Internet routing</li>
</ul>
</li>
</ul>
<p>Internet Packets：</p>
<ul>
<li>An IP packet, called IP datagram, consists of two parts:Header+Data Area</li>
<li>Header
<ul>
<li>Contains source and destination address</li>
<li>Fixed-size fields</li>
</ul>
</li>
<li>Data Area  (Payload)
<ul>
<li>Variable size up to 64K</li>
<li>No minimum size</li>
</ul>
</li>
</ul>
<p>IPv4 datagram format:</p>
<ul>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222101254.png"
        data-srcset="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222101254.png, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222101254.png 1.5x, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222101254.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222101254.png"
        title="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222101254.png" /></li>
</ul>
<p>IP Address Details:</p>
<ul>
<li>An IPv4 address has 32 bits (4 bytes) – written like 192.0.2.53
<ul>
<li>It consists of two parts: prefix identifies network and suffix identifies host</li>
<li>It was announced in Jan 2011 that all IPv4 addresses were allocated out.</li>
</ul>
</li>
<li>An IPv6 address is 128 bits, written in hexadecimal. It looks like
<ul>
<li>2001:0db8::53. The mark “::” means all zeros in between. So 2001:0db8::53 is 2001:0db8:0000:0000:0000:0000:0000:53</li>
</ul>
</li>
<li>Global authority assigns unique prefix to network (ICANN)
<ul>
<li>Internet Corporation for Assigned Names and Numbers <a href="http://www.icann.org/" target="_blank" rel="noopener noreffer">http://www.icann.org/</a></li>
</ul>
</li>
<li>Local administrator assigns unique suffix to host</li>
</ul>
<p>IPv4 Addresses：</p>
<ul>
<li>The Classful Addressing:</li>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143028.png"
        data-srcset="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143028.png, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143028.png 1.5x, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143028.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143028.png"
        title="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143028.png" /></li>
</ul>
<p>Classes and Network Sizes：</p>
<ul>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143051.png"
        data-srcset="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143051.png, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143051.png 1.5x, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143051.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143051.png"
        title="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143051.png" /></li>
<li>Network size is determined by number of bits for hosts
<ul>
<li>Class A large</li>
<li>Class B medium</li>
<li>Class C small</li>
</ul>
</li>
</ul>
<p>Are there enough addresses?</p>
<ul>
<li>Unfortunately No!
<ul>
<li>32 bits  4 billion unique addresses.</li>
<li>but addresses are assigned in chunks, most of them are not used (particularly class D addresses for multicast).</li>
<li>techniques, such as CIDR, NAT, and DHCP are introduced to relief the shortage of IP addresses.</li>
</ul>
</li>
<li>Expanding the address space!
<ul>
<li>IPv6 128 bit addresses</li>
<li>Difficult to deploy (require changes to the core of the Internet)</li>
<li>The transition from IPv4 to IPv6 is very slow</li>
</ul>
</li>
</ul>
<p>IP address allocation by Geographical Regions：</p>
<ul>
<li>To simplify routing tables, since 1993, IP address allocation follows the geographical regions:
<ul>
<li>194.0.0.0 to 195.255.255.255 for Europe</li>
<li>198.0.0.0 to 199.255.255.255 for North America</li>
<li>200.0.0.0 to 201.255.255.255 for Central &amp; South America</li>
<li>202.0.0.0 to 203.255.255.255 for Asia Pacific</li>
</ul>
</li>
<li>Routing table size can be greatly reduced, e.g., routers outside Europe can have a single table entry for range: 194.0.0.0 - 195.255.255.255 to be routed to the nearest Europe gateway.</li>
</ul>
<p>Subnets and Subnet Masks：</p>
<ul>
<li>Subnets allow a big organization (e.g., university), who received a class A or B network address, to further divide its hosts into subnets (LANs):
<ul>
<li>The host portion of address is further partitioned into subnet number and host number.</li>
<li>Each LAN is assigned a subnet number (subnet address).</li>
<li>To route an IP packet, its dest-IP addr is AND-ed with the subnet-mask, obtaining a subnet number. It is forwarded to the router of the dest-subnet:</li>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143336.png"
        data-srcset="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143336.png, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143336.png 1.5x, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143336.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143336.png"
        title="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143336.png" /></li>
<li>The dest-subnet router routes the packet to dest-host using host #.</li>
</ul>
</li>
</ul>
<p>Routing Using Subnets：<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143408.png"
        data-srcset="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143408.png, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143408.png 1.5x, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143408.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143408.png"
        title="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143408.png" /></p>
<p>Cslab Subnet Interconnction：</p>
<ul>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143436.png"
        data-srcset="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143436.png, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143436.png 1.5x, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143436.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143436.png"
        title="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143436.png" /></li>
</ul>
<p>Routing Table in CSlab：</p>
<ul>
<li>CSlab has 22 LANs connected to a single router. The router is connected to CSC’s router.</li>
<li>The routing table is very small, only contains 22 VLANs and an entry pointing to CSC router 144.214.138.21 (0.0.0.0 for default routing).</li>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143548.png"
        data-srcset="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143548.png, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143548.png 1.5x, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143548.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143548.png"
        title="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143548.png" /></li>
</ul>
<p>CIDR-Classless InterDomain Routing：</p>
<ul>
<li>The classful addressing
<ul>
<li>inefficient in use of address space, resulting in address space exhaustion</li>
<li>e.g., it has to allocate a class B net address (for up to 65K hosts) to a network with only 1K host.</li>
</ul>
</li>
<li>CIDR: subdivide a network addr (class A, B or C) into any length to make efficient use of IP addr space (this subdividing is visible to entire Internet).
<ul>
<li>network portion of address of arbitrary length</li>
<li>address format: a.b.c.d/x, where x is # of bits for network address</li>
</ul>
</li>
<li>Example of CIDR subdividing a class B net address: 194.24.0.0</li>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143712.png"
        data-srcset="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143712.png, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143712.png 1.5x, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143712.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143712.png"
        title="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143712.png" /></li>
</ul>
<p>CIDR Routing</p>
<ul>
<li>Each entry in CIDR routing table contains a base address and a subnet mask (same as routing in subnets).</li>
<li>For routing an IP packet, its destination IP addr is Boolean ANDed with the subnet mask to see if it matches the entry’s base addr (the longest match is used if multiple matches found).</li>
<li>The packet is routed out via the matched entry’s outgoing link.</li>
<li>Not all routers perform CIDR. (if all routers adopt CIDR, network portion of addresses can be of any length!)</li>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143759.png"
        data-srcset="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143759.png, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143759.png 1.5x, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143759.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143759.png"
        title="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143759.png" /></li>
</ul>
<p>NAT- Network Address Translation:</p>
<ul>
<li>To relief the shortage of IP addresses, NAT technique uses only a small number of external IP addresses for communicating with outside, and hide local IP addresses from outside (so these local IP addresses can be re-used elsewhere):
<ul>
<li>All Internet traffic to outside has to go through a NAT box, where the internal IP address (the source IP addr) is replaced by an external IP address.</li>
<li>The source port # field in the IP packet is replaced by the index pointing to the entry in the NAT box’s translation table. This entry contains the internal IP addr and the original source port #.</li>
<li>When an outside IP packet arrives at the NAT box, its destination port # is extracted and used as an index to the translation table, where the original IP addr and port # are extracted and placed back to the packet.</li>
</ul>
</li>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143844.png"
        data-srcset="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143844.png, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143844.png 1.5x, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143844.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143844.png"
        title="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143844.png" /></li>
</ul>
<p>NAT in operation:</p>
<ul>
<li>Translate addresses when packets traverse through NAT.</li>
<li>Use port numbers to identify internal IP users.</li>
<li>This is a dirty way to fix the problem and only works for TCP/UDP traffic.</li>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143923.png"
        data-srcset="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143923.png, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143923.png 1.5x, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143923.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143923.png"
        title="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222143923.png" /></li>
</ul>
<p>Dynamic Host Configuration Protocol (DHCP):</p>
<ul>
<li>To make NAT work, three ranges of IP addresses have been declared for private use (called unregistered addresses):
<ul>
<li>10.0.0.0 – 10.255.255.255/8</li>
<li>172.16.0.0 – 172.31.255.255/12</li>
<li>192.168.0.0 – 192.168.255.255/16</li>
</ul>
</li>
<li>The allocation of the private IP addresses is done by Dynamic Host    Configuration Protocol, a service running on a router:
<ul>
<li>lease IP addresses for short time period (particularly for mobile users)</li>
<li>hosts may refresh addresses periodically</li>
</ul>
</li>
</ul>
<p>DHCP in Operation:</p>
<ul>
<li>A DHCP server may serve multiple LANs (subnets).</li>
<li>A DHCP relay-agent is needed on each LAN to enable hosts on this LAN to reach DHCP server via a broadcast message.</li>
<li>When a device (host) is booted up, it broadcasts a DHCP discover packet (to request / discover an IP address).</li>
<li>DHCP discover packet is intercepted by the DHCP agent on the same LAN and forwarded to the DHCP server.</li>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222144100.png"
        data-srcset="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222144100.png, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222144100.png 1.5x, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222144100.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222144100.png"
        title="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222144100.png" /></li>
</ul>
<p>Address Resolution Problem:</p>
<ul>
<li>IP layer specifies the next hop router (destination) by IP addresses. When it gives an IP packet to the underlying network (e.g., Ethernet) for transmission, it needs to insert the “physical addresses” to the packet:
<ul>
<li>How to determine the MAC addr of an IP addr?</li>
</ul>
</li>
</ul>
<p>Network Card Hardware Address(Ethernet address):</p>
<ul>
<li>Ethernet addresses (48-bits), in the format of:
0e: 3c: 24: 3a: 03: 06
are hard-wired into network cards at factories.</li>
<li>IEEE allocates Ethernet addr to manufactures to ensure the uniqueness of Ethernet addr.</li>
<li>Most network cards understand only hardware addr, not IP addr at all.</li>
</ul>
<p>ARP- Address Resolution Protocol:</p>
<ul>
<li>ARP provides a mapping from IP addr to physical addr. Suppose A knows B&rsquo;s IP addr and wants to know B’s physical addr:
<ul>
<li>A broadcasts ARP query packet, containing B&rsquo;s IP address all machines on the LAN receive ARP query</li>
<li>B receives ARP packet, replies to A with its (B&rsquo;s) physical layer address</li>
<li>A caches (saves) IP-to-physical address pairs until information becomes old (times out)
<ul>
<li>soft state: information that times out (goes away) unless refreshed</li>
</ul>
</li>
<li>ARP shell command: arp</li>
</ul>
</li>
</ul>
<p>ARP Cache and RARP:</p>
<ul>
<li>ARP maintains a cache of the recent IP to physical address mappings to make address translation fast</li>
<li>Each entry is aged (usually the lifetime is 20 minutes) forcing periodic updates of the cache</li>
<li>ARP replies are often broadcast so that all hosts can update their caches</li>
<li>RARP (Reverse ARP) protocol allows a newly booted-up host to find its own IP address from its physical address (RARP was largely replaced by DHCP).</li>
</ul>
<p>OSPF-Interior Gateway Routing Protocol :</p>
<ul>
<li>Internet consists of a large number of ASes (autonomous systems). Each AS, operated by an organization (or university), can use its own routing algorithm inside. Nevertheless, OSPF (open shortest path first) is a de facto routing standard for intra-AS routing.
<ul>
<li>An AS is often divided into numbered areas (a subnet or a set of contiguous subnets).</li>
<li>Each AS has a backbone, called area 0. At least one router in each area is connected to the backbone routers.</li>
<li>Some backbone routers (called AS boundary routers) are connected to other ASes for inter-AS routing.</li>
</ul>
</li>
</ul>
<p>OSPF Algorithm:</p>
<ul>
<li>OSPF abstracts the routers within the AS into a connected graph and assign weight to each edge (distance, delay, etc).</li>
<li>Each router periodically floods Link-State-Update message to its adjacent routers, thus each router knows the topology within the area.</li>
<li>Intra-area routing: each router uses the link state database and runs the shortest path to the destination router.</li>
<li>Inter-area routing: the source router -&gt; backbone -&gt; the destination area -&gt; destination router</li>
<li>Inter-AS routing, the source router -&gt; backbone -&gt; AS boundary router -&gt; destination AS boundary router (via BGP) -&gt; dest-router</li>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222144608.png"
        data-srcset="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222144608.png, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222144608.png 1.5x, https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222144608.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222144608.png"
        title="https://raw.githubusercontent.com/JF-011101/Image_hosting_rep/main/20211222144608.png" /></li>
</ul>
<p>BGP – Exterior Gateway Routing Protocol:</p>
<ul>
<li>Inter-AS traffics are routed by BGP (Border Gateway Protocol):
<ul>
<li>Exterior gateway protocol concerns more on routing policies, such as no transit traffic through certain ASes, no relay for certain ASes, etc.</li>
<li>BGP is a distance vector protocol. Each entry in routing table contains: dest, next-hop-to-dest, distance (# of hops). It always chooses the next hop neighbor with the shortest distance to a destination to forward the packet, called next-hop-routing.</li>
<li>Each BGP router exchanges routing info with its neighbors (distances &amp; next-hop to all destinations). After collecting the info from neighbors, a BGP router can update (build up) its own routing table.</li>
</ul>
</li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2022-10-08 19:55:40&nbsp;<a class="git-hash" href="https://github.com/dillonzq/LoveIt/commit/08d4d6cf8a78e5a1cb353b041919a9e49a704d6a" target="_blank" title="commit by JF-011101(2838264218@qq.com) 08d4d6cf8a78e5a1cb353b041919a9e49a704d6a: feat">
                                    <i class="fas fa-hashtag fa-fw"></i>08d4d6c</a></span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://jefofrank.xyz/distributedsystem_hongweidu_07/" data-title="DistributedSystem_HongweiDu_07" data-hashtags="distributed system"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://jefofrank.xyz/distributedsystem_hongweidu_07/" data-hashtag="distributed system"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Reddit" data-sharer="reddit" data-url="https://jefofrank.xyz/distributedsystem_hongweidu_07/"><i class="fab fa-reddit fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://jefofrank.xyz/distributedsystem_hongweidu_07/" data-title="DistributedSystem_HongweiDu_07"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://jefofrank.xyz/distributedsystem_hongweidu_07/" data-title="DistributedSystem_HongweiDu_07"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="分享到 百度" data-sharer="baidu" data-url="https://jefofrank.xyz/distributedsystem_hongweidu_07/" data-title="DistributedSystem_HongweiDu_07"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/baidu.svg"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/distributed-system/">distributed system</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/distributedsystem_hongweidu_06/" class="prev" rel="prev" title="DistributedSystem_HongweiDu_06"><i class="fas fa-angle-left fa-fw"></i>DistributedSystem_HongweiDu_06</a>
            <a href="/distributedsystem_hongweidu_08/" class="next" rel="next" title="DistributedSystem_HongweiDu_08">DistributedSystem_HongweiDu_08<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.89.0">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/jf-011101" target="_blank">Jefo</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span><span class="icp-splitter">&nbsp;|&nbsp;</span><br class="icp-br"/>
                    <span class="icp"><a href="https://beian.miit.gov.cn/">赣ICP备2022007470号-1</a></span></br>
                <span id="busuanzi_container_site_pv">
                    访问量 <span id="busuanzi_value_site_pv"></span> 次
                </span>
                &nbsp;|&nbsp;
                <span id="busuanzi_container_site_uv">
                    访客数 <span id="busuanzi_value_site_uv"></span> 人次
                </span>
                </br><script>
                    function siteTime() {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = 2021;
                        var startMonth = 3;
                        var startDate = 27;
                        var startHour = 19;
                        var startMinute = 15;
                        var startSecond = 11;
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);
                        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                            minutes);
                        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                            diffMinutes * minutes) / seconds);
                        if (startYear == todayYear) {
                            
                            document.getElementById("sitetime").innerHTML = "已安全运行 " + diffDays + " 天 " + diffHours +
                                " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                        } else {
                            
                            document.getElementById("sitetime").innerHTML = "已安全运行 " + diffYears + " 年 " + diffDays +
                                " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                        }
                    }
                    setInterval(siteTime, 1000);
                </script>
                    <span id="sitetime">载入运行时间...</span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.css"><script type="text/javascript" src="https://jefos-blog.disqus.com/embed.js" defer></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@7.0.4/dist/typeit.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{},"data":{"id-1":"绿叶律动","id-2":"绿叶律动"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"algoliaAppID":"J0OW8CCKJZ","algoliaIndex":"JF-2","algoliaSearchKey":"3b4a19e831c95174aca4c03fcdf95f5c","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
