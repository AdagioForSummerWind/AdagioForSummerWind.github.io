---
title: "interview"
date: 2022-06-28T15:30:06+08:00
lastmod: 2022-08-28
tags: [interview]
categories: [interview]
slug: all-interview
draft: true
---



##  消息队列

### 为什么需要消息队列

解耦，异步处理，削峰/限流

### Kafka的文件存储机制

Kafka中消息是以topic进行分类的，生产者通过topic向Kafka broker发送消息，消费者通过topic读取数据。然而topic在物理层面又能以partition为分组，一个topic可以分成若干个partition。partition还可以细分为segment，一个partition物理上由多个segment组成，segment文件由两部分组成，分别为“.index”文件和“.log”文件，分别表示为segment索引文件和数据文件。这两个文件的命令规则为：partition全局的第一个segment从0开始，后续每个segment文件名为上一个segment文件最后一条消息的offset值。

### Kafka 如何保证可靠性

如果我们要往 Kafka 对应的主题发送消息，我们需要通过 Producer 完成。前面我们讲过 Kafka 主题对应了多个分区，每个分区下面又对应了多个副本；为了让用户设置数据可靠性， Kafka 在 Producer 里面提供了消息确认机制。也就是说我们可以通过配置来决定消息发送到对应分区的几个副本才算消息发送成功。可以在定义 Producer 时通过 acks 参数指定。这个参数支持以下三种值：
* acks = 0：意味着如果生产者能够通过网络把消息发送出去，那么就认为消息已成功写入 Kafka 。在这种情况下还是有可能发生错误，比如发送的对象无能被序列化或者网卡发生故障，但如果是分区离线或整个集群长时间不可用，那就不会收到任何错误。在 acks=0 模式下的运行速度是非常快的（这就是为什么很多基准测试都是基于这个模式），你可以得到惊人的吞吐量和带宽利用率，不过如果选择了这种模式， 一定会丢失一些消息。
* acks = 1：意味若 Leader 在收到消息并把它写入到分区数据文件（不一定同步到磁盘上）时会返回确认或错误响应。在这个模式下，如果发生正常的 Leader 选举，生产者会在选举时收到一个 LeaderNotAvailableException 异常，如果生产者能恰当地处理这个错误，它会重试发送悄息，最终消息会安全到达新的 Leader 那里。不过在这个模式下仍然有可能丢失数据，比如消息已经成功写入 Leader，但在消息被复制到 follower 副本之前 Leader发生崩溃。
* acks = all（这个和 request.required.acks = -1 含义一样）：意味着 Leader 在返回确认或错误响应之前，会等待所有同步副本都收到悄息。如果和min.insync.replicas 参数结合起来，就可以决定在返回确认前至少有多少个副本能够收到悄息，生产者会一直重试直到消息被成功提交。不过这也是最慢的做法，因为生产者在继续发送其他消息之前需要等待所有副本都收到当前的消息。

### Kafka消息是采用Pull模式，还是Push模式

Kafka最初考虑的问题是，customer应该从brokes拉取消息还是brokers将消息推送到consumer，也就是pull还push。在这方面，Kafka遵循了一种大部分消息系统共同的传统的设计：producer将消息推送到broker，consumer从broker拉取消息。push模式下，当broker推送的速率远大于consumer消费的速率时，consumer恐怕就要崩溃了。最终Kafka还是选取了传统的pull模式。Pull模式的另外一个好处是consumer可以自主决定是否批量的从broker拉取数据。Pull有个缺点是，如果broker没有可供消费的消息，将导致consumer不断在循环中轮询，直到新消息到t达。为了避免这点，Kafka有个参数可以让consumer阻塞知道新消息到达。

### Kafka是如何实现高吞吐率的

1. 顺序读写：kafka的消息是不断追加到文件中的，这个特性使kafka可以充分利用磁盘的顺序读写性能
2. 零拷贝：跳过“用户缓冲区”的拷贝，建立一个磁盘空间和内存的直接映射，数据不再复制到“用户态缓冲区”
3. 文件分段：kafka的队列topic被分为了多个区partition，每个partition又分为多个段segment，所以一个队列中的消息实际上是保存在N多个片段文件中
4. 批量发送：Kafka允许进行批量发送消息，先将消息缓存在内存中，然后一次请求批量发送出去
5. 数据压缩：Kafka还支持对消息集合进行压缩，Producer可以通过GZIP或Snappy格式对消息集合进行压缩

### Kafka判断一个节点还活着的两个条件

1. 节点必须可以维护和 ZooKeeper 的连接，Zookeeper 通过心跳机制检查每个节点的连接
2. 如果节点是个 follower,他必须能及时的同步 leader 的写操作，延时不能太久

##  Dubbo

### Dubbo的容错机制

1. 失败自动切换，当出现失败，重试其它服务器。通常用于读操作，但重试会带来更长延迟。可通过 retries="2" 来设置重试次数
2. 快速失败，只发起一次调用，失败立即报错。通常用于非幂等性的写操作，比如新增记录。
3. 失败安全，出现异常时，直接忽略。通常用于写入审计日志等操作。
4. 失败自动恢复，后台记录失败请求，定时重发。通常用于消息通知操作。
5. 并行调用多个服务器，只要一个成功即返回。通常用于实时性要求较高的读操作，但需要浪费更多服务资源。可通过 forks="2" 来设置最大并行数。
6. 广播调用所有提供者，逐个调用，任意一台报错则报错。通常用于通知所有提供者更新缓存或日志等本地资源信息

### Dubbo注册中心挂了还可以继续通信么

可以，因为刚开始初始化的时候，消费者会将提供者的地址等信息拉取到本地缓存，所以注册中心挂了可以继续通信。

### Dubbo提供的线程池

1. fixed：固定大小线程池，启动时建立线程，不关闭，一直持有。 
2. cached：缓存线程池，空闲一分钟自动删除，需要时重建。 
3. limited：可伸缩线程池，但池中的线程数只会增长不会收缩。(为避免收缩时突然来了大流量引起的性能问题)。

### Dubbo框架设计结构

1. 服务接口层：该层是与实际业务逻辑相关的，根据服务提供方和服务消费方的业务设计对应的接口和实现。
2. 配置层：对外配置接口，以ServiceConfig和ReferenceConfig为中心，可以直接new配置类，也可以通过spring解析配置生成配置类。
3. 服务代理层：服务接口透明代理，生成服务的客户端Stub和服务器端Skeleton，以ServiceProxy为中心，扩展接口为ProxyFactory。
4. 服务注册层：封装服务地址的注册与发现，以服务URL为中心，扩展接口为RegistryFactory、Registry和RegistryService。可能没有服务注册中心，此时服务提供方直接暴露服务。
5. 集群层：封装多个提供者的路由及负载均衡，并桥接注册中心，以Invoker为中心，扩展接口为Cluster、Directory、Router和LoadBalance。将多个服务提供方组合为一个服务提供方，实现对服务消费方来透明，只需要与一个服务提供方进行交互。
6. 监控层：RPC调用次数和调用时间监控，以Statistics为中心，扩展接口为MonitorFactory、Monitor和MonitorService。
7. 远程调用层：封将RPC调用，以Invocation和Result为中心，扩展接口为Protocol、Invoker和Exporter。Protocol是服务域，它是Invoker暴露和引用的主功能入口，它负责Invoker的生命周期管理。Invoker是实体域，它是Dubbo的核心模型，其它模型都向它靠扰，或转换成它，它代表一个可执行体，可向它发起invoke调用，它有可能是一个本地的实现，也可能是一个远程的实现，也可能一个集群实现。
8. 信息交换层：封装请求响应模式，同步转异步，以Request和Response为中心，扩展接口为Exchanger、ExchangeChannel、ExchangeClient和ExchangeServer。
9. 网络传输层：抽象mina和netty为统一接口，以Message为中心，扩展接口为Channel、Transporter、Client、Server和Codec。
10. 数据序列化层：可复用的一些工具，扩展接口为Serialization、 ObjectInput、ObjectOutput和ThreadPool。



##  面试问题
### 外包公司能不能去

外包合同和正式合同的区别:

1. 外包合同不是和本单位签订的。所以福利可能差一些。
2. 签的时间比较短，稳定性差。
3. 外包的优势，就业门槛低

适合转行，失业解决温饱问题的。

### 你如何看待加班？

1. 回答hr，你可以接受加班，表达一下你的意愿
2. 告诉hr你的工作效率非常高，可以避免不必要的加班。最后追问，公司加班的原因。

正确回答：

1. 如果出现加班，我首先会考虑是不是我的原因导致的，如果是的话，我会尽量加快提高工作效率，减少加班情况的发生。
2. 如果是项目比较急，加班，我也会接受加班的。
3. 但是我不是为了加班而加班，为了表现自己多努力工作而加班。我更希望提高自己的工作效率，合理安排自己的加班时间，这样可以协调工作和生活。
4. 如果公司有需要我是可以加班，但是呢，我会尽量在周一在周五之内完成自己的工作。周六日好好学习充电以备下周更高效的工作。
5. 追问hr：那么加班严重到什么程度，一般是为了什么而加班。



### 面试问题｜被录用后如何开展工作？

1. 我会按照领导的指示和需求，了解工作情况，其次的话，我会制作一个工作计划表，然后开展工作
2. 注重工作态度和学习能力

### 面试问题｜你从上份工作中学到了什么？

1. 学会开发的流程，这样一来，让我的工作更加工业化和职业化
2. 在工作上，我学会了如何从项目中分析问题和解决问题
3. 工作之外，我还会学习和充电

### 面试问题 ｜你希望通过这份工作获得什么？满分话术分享

对于我来说，我从事的工作还是比较适合我的，我从事的工作可以充分发挥我的专长，这样的话可以带给我一种满足感，同时，我希望这一份工作具有挑战性，这样的话可以促使我提升自己

### 面试问题 ｜谈谈你失败的一次经历？满分话术分享

hr的目的：想知道你遇到挫折之后你的承受能力有多强，你的学习能力有多强，收获了什么，下一次遇到什么问题，你应该如何去做

我：举例子：。。。。。

最后，我有时候认为失败比成功更重要，失败可以让我积累一定的经验和财富，这样的话，以后遇到同样的事情，我就不会再犯同样的错误了

### 面试问题 ｜你有没有参加其他公司面试？

hr的动机：

1. 判断求职者是否有明确的职业规划，而不是今天投这一行,明天找另外一行
2. 根据求职者面试情况，给求职者定薪资

话术：

1. 在投递简历之前，我已经对业内几家有口碑的公司进行了背调，并且结合我的职业规划进行筛选和投递，来您公司之前我已经去面试过其他家岗位，并且收到几家offer  。但是呢，从今天的面试来看，我觉得贵公司的企业文化及实力非常符合我的职业发展，并且我的工作履历和贵公司的岗位职责描述是相符的，所以我也真诚希望贵公司可以考虑我(不要说其他公司的细节，大忌)
2. 再面试之前我做了很多准备，并且通过这一次面试，我对贵公司有了一个了解和认识。觉得和我的求职意向还是满符合的。我希望贵公司可以给我一个机会，让我为贵公司做出一些贡献。贵公司是我参加面试这么多





### 薪资技巧

薪资：

1. 面试阶段不要提薪酬，等公司确定要你之后再谈；不要狮子大张口

2. 不要工资造假 

3. 谈钱不可耻，不卑不亢的提出薪资要求

4. 不要自爆（比如：重发展机会，不在乎工资）可以表达，本人很欣赏公司，也很开心能加入，对于薪酬也是一个重要的考虑纬度，然后与人资展开具体沟通（喷血，我都是这么说的![](https://i0.hdslb.com/bfs/emote/485a7e0c01c2d70707daae53bee4a9e2e31ef1ed.png@100w_100h.webp))

5. 不要过早亮出底牌，报出具体金额，应先给到方向性的回复，争取让对方先报数。

   - 比如：相较于现有的工资水平，有一定合理比例的涨幅，也想了解一下公司对我offer的看法；具体询问公司的工资构成。如果对方还是不说数字的话，报出去的工资要比底线高10-20%。
   - 能否先问一下公司的薪酬结构。比如基础薪资和绩效奖金的构成，绩效奖金的发放标准，公司有没有年终奖，项目奖金，公司有没有期权，五险一金的缴纳方式，公司有没有期权，公司上班时间，周末上班的计薪方式。
   - 一定要争取对方先报数。 比如hr和我们介绍公司的薪酬体系，你现在是什么样的想法呢。这时候你可以说：我希望总包上，相较于上一份工作一定有合理比例的涨幅，也想听听看公司给我目前聊下给我offer提议。这时候，有两种情况：
     - hr给你一个具体的数字。那你就给这个数字具体一个反馈，如果符合预期，就愉快的接受，如果不符合，就说，可能这距离距离我的预期还有一定的差距，看你能否给到xxx呢。or我这边的期望是不低于xxx
     - hr继续追问，你预计的涨幅是多少呢。你期望的薪资数字是怎么样的呢。这时候会回答，比自己底线高10%-20%的数字

   - 拿现有的去argue。
     - 说你上一份工作中拿到额外的奖励，升职加薪等
     - 说目前拿到的offer是多少，具体哪一个公司不说了。比如xxxx行业的公司给我offer是多少。
     - 说你工作上，经验上的优势。比如，这个岗位，你有非常成功的经验，能够快速上手；这个岗位所要求的技术栈，你已经非常熟练的运用了。

6. 说出自己的优势的论据

7. 我最近刚换工作，薪资方面还比较满意。
   分享几点我的经历：
   1、根据岗位对标信息，认为自己绝对有信心胜任此岗位的，绝不松口，绝不给对方压价的余地，如果对方使用话术提问一些比较难刻薄的问题，那么可以拒不作答或者反问，只要别吵起来，都没有问题，HR的职责是花小钱招大能，最终决定权一般都在用人单位手中不在HR手中。
   2、不要让HR知道你只面试了这一家或者圈子很小的几家公司，因为这几家公司有可能中高层互通有无，对你的信息和情况掌握得十分清楚，甚至直接电联你直属上司，非常非常被动。面试的时候HR掌握你的信息越多，越不利于你谈判。甚至可以用跨多个行业的应聘资历反过来给HR施加压力。
   3、面试过程中回答问题所表达的高度和视角要高于应聘岗位，给用人单位一种：“卧槽！这是个宝才！这下捡到鬼了！”这种感觉，HR一般还是要听用人单位的意见，如果用人单位说这个人一定要拿下，那么HR是压不住你的薪资的。
   4、不要给自己画条条框框，比如：看别人跳槽升1级比较多，升2级的寥寥无几。就抱着我肯定也只能升1级的想法，是完全没有道理的。只要招聘的岗位能给你实现想法的平台，能给你展现才华的舞台，就勇敢去追！有底气有信心就去搏一搏，便是失败了，也明了了自身的不足与差距在哪里。
   我面试过程中，升了两级，涨了一次工资，省了差不多3年时间：
   P1：HR找到我，问我有没有意向加入A+1岗位（我当前处于A岗位），我表示完全没有兴趣，没有谈的必要，于是他说那么A+2的岗位有没有兴趣，我表示吸引力一般般，但可以接受面试。
   P2：第一轮面试通过，面谈结果定岗A+3，薪资方便我表示低于底线X-4就不必谈了。于是第一轮薪资报价是X-2，进入第二轮面试（当对于目前年薪X，因为绩效优占比较大，所以跳槽有一定的下浮是正常的）
   P3：第二轮面试通过，面谈结果定岗A+3，并且表示薪资X-2已经是A+3岗位封顶水平。我表示没有谈的必要了，此offer的“岗位+薪资综合水平”对我完全没有吸引力。
   P4：HR上报审批意见，最终定岗A+4，薪资X+3+期权（处于A+4岗位中上水平）。

8. 关于不要给自己画条条框框这一点我举个例子，我室友和我是同岗位，他的薪资比我还高6个。可以讲，他跳槽之后，+2职级的情况下，没有哪家公司能给出他当前水平的薪资。他陷入了“不跳槽要命，跳槽就亏钱”的情境之中。他就是给自己画了一个“我跳槽只能升2级”的框框里，现在他新面试的岗位比原先高3级，对方公司明确表示，你这点薪资要求完全没有问题，属于该要钱的时候要少了的典型。
   还有就是涨薪幅度的问题，不要受到30%、50%这种统计数字的束缚，这些数字只能代表大多数或者平均数，不跨行涨300%的，跨行涨500%的这种人虽然少，但不是没有！

9. 我个人的想法是，一般来说选**offer钱多 事少 离家近** 至少占一个。但对于应届生，你是否能学到东西才是最重要的。这里的学到东西说的不是hr许诺给你的个人成长培训资源之类的，而是会不会为你以后的跳槽提高身价。职场无非就是个工作能力和人情世故，薪资福利该问问该谈谈，千万不要不好意思，不然折磨的只会是自己。





💡💡先说下楼主本人背景：双非硕士，无具体实习经验，但项目经验比较丰富，在校也有相关的获奖情况
💈12月1号当天收到补录通过的通知，然后前天就到了和HR谈薪的环节。（偷偷说个小秘密，原来校招生也是有谈薪的余地的）
·
这个环节可谓精彩，鹅厂的HR也真的是专业🎏
谈薪流程如下：
💎- HR：同学，你期望的薪资是多少呢？（第一个坑：千万别先说）

- 我：我已经通过您们的面试，相信贵司是一个珍惜人才的公司，已经有一个合理的薪酬给到我，您直接跟我说就好。（不入坑）
💎- HR：好的，同学你的整体面试还不错，我们这边给出了一个SP的评价，请问同学你这边还有其它公司的offer吗？（第二个坑：慎重说）
- 我：谢谢您们的认可，目前的话我是有几个offer在手的，但具体还没有确定接受哪个，还正在考虑中。（模糊回答）
💎- HR：那目前你这边已经接了哪些offer呢，以及对应的薪酬是如何的呢？（第三个坑：看情况砍价）
- 我：目前的话主要是字节、顺丰等头部企业，薪酬其实每一家都不一样，这个很难统一说。（继续打太极拳）
💎- HR：好的，那我们这边目前给你的薪酬为：18k * 16 + 4k * 12 + 2w签字费 + 6w 股票 （主动说出薪酬） 总包40W+，还有一些诸如此类的福利等等
- 我：明白，这个薪酬相对来说还是比较ok的，和其它几家公司也差不多，我会好好考虑一下（压住激动的心，先压一压）
💎- HR：同学你这边是还有其它的考虑吗？你可以说一说（似乎上钩了）
- 我：对，因为我同学也进了咱们公司，但他的薪酬似乎比我好一些。（的确存在，但我同学是算法岗）
💎- HR：哦，那你自己有没有目标的薪酬呢？（这时候还不能急）
- 我：哈哈，我当然希望能够高一些，我想的是，基础工资那里希望是19k，签字费有3w，这个是我的想法（明确说出自己的希望）
💎- HR：明白，这样，我跟部门经理先说一下你的情况，然后再回电你。
（过程15分钟挂机，心里比较忐忑）
·
再次回电
💎- HR：同学，我这边已经沟通过了，你这边提的这个要求我们可以满足，前提是你需要尽快办理三方。
- 我：好的，谢谢您！
·
至此，不到10分钟的谈话，薪酬从18k * 16 + 4k * 12 + 2w签字费 + 6w 股票 = 41.6W 变成了 19k * 16 + 4k * 12 + 3w签字费 + 6w 股票 = 44.2W 
💡💡也就是相当于我10分钟赚了2.6W💡💡
·
☎️回顾整体面试给我的感觉就是，没有实习经历的确是我的硬伤，但我的项目经历是我的亮点，扬长避短，而且在面试中一定是表现冷静、沉着，不断通过交流展示自己的优点。
·
🔋好了，至此，鹅厂的谈薪已经结束，也正在准备三方了。面试过程还有很多有趣的东西没来得及分享，如果想了解的可以私戳我哦。谢谢大家的喜欢，祝大家也有满意的offer！！🧧🧧

